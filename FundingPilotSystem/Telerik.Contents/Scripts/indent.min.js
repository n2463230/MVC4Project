function indent(n,t){var i=dom.name(n)!="td"?"marginLeft":"paddingLeft";if(t===undefined)return n.style[i]||0;t>0?n.style[i]=t+"px":(n.style[i]="",n.style.cssText==""&&n.removeAttribute("style"))}function IndentFormatter(){var n=new BlockFormatFinder([{tags:blockElements}]);this.apply=function(t){var f=n.findSuitable(t),e,u,i,c,l;if(f.length){for(e=[],u=0;u<f.length;u++)dom.is(f[u],"li")?$(f[u]).index()==0?e.push(f[u].parentNode):$.inArray(f[u].parentNode,e)<0&&e.push(f[u]):e.push(f[u]);while(e.length)if(i=e.shift(),dom.is(i,"li")){var h=i.parentNode,o=$(i).prev("li"),s=o.find("ul,ol").last(),r=$(i).children("ul,ol")[0];if(r&&o[0])s[0]?(s.append(i),s.append($(r).children()),dom.remove(r)):(o.append(r),r.insertBefore(i,r.firstChild));else for(r=o.children("ul,ol")[0],r||(r=dom.create(i.ownerDocument,dom.name(h)),o.append(r));i&&i.parentNode==h;)r.appendChild(i),i=e.shift()}else c=parseInt(indent(i))+30,indent(i,c)}else l=new BlockFormatter([{tags:blockElements}],{style:{marginLeft:30}}),l.apply(t)},this.remove=function(t){for(var o=n.findSuitable(t),u,r,i,e,s,h,f=0;f<o.length;f++){if(r=$(o[f]),r.is("li"))if(i=r.parent(),e=i.parent(),e.is("li,ul,ol")&&!indent(i[0])){s=r.nextAll("li"),s.length&&$(i[0].cloneNode(!1)).appendTo(r).append(s),e.is("li")?r.insertAfter(e):r.appendTo(e),i.children("li").length||i.remove();continue}else{if(u==i[0])continue;u=i[0]}else u=o[f];h=parseInt(indent(u))-30,indent(u,h)}}}function IndentCommand(n){n.formatter={toggle:function(n){(new IndentFormatter).apply(RangeUtils.nodes(n))}},Command.call(this,n)}function OutdentCommand(n){n.formatter={toggle:function(n){(new IndentFormatter).remove(RangeUtils.nodes(n))}},Command.call(this,n)}function OutdentTool(){Tool.call(this,{command:OutdentCommand});var n=new BlockFormatFinder([{tags:blockElements}]);this.init=function(n){n.attr("unselectable","on").addClass("t-state-disabled")},this.update=function(t,i){for(var u=n.findSuitable(i),f,e,r=0;r<u.length;r++)if(f=indent(u[r]),f||(e=$(u[r]).parents("ul,ol").length,f=dom.is(u[r],"li")&&(e>1||indent(u[r].parentNode))||dom.ofType(u[r],["ul","ol"])&&e>0),f){t.removeClass("t-state-disabled");return}t.addClass("t-state-disabled").removeClass("t-state-hover")}}