(function(n){function c(n){var t=0,i;for(i in n)n.hasOwnProperty(i)&&t++;return t}function l(t,i){var r={owner:[null]};return n.each(i,function(){var i=this,u=i.owner;if(u&&n.contains(u,t))return r=n.extend(r,i),r.selector&&(r.owner=n(t).closest(r.selector)[0]),!1}),r}var t=n.telerik,i=function(){},r={},u={},o={},f={owner:[null]},e=t.isTouch?"touchend":"mouseup",s=t.isTouch?"touchstart":"mousedown",h=t.isTouch?"touchmove":"mousemove",a={scope:"default",drop:i,over:i,out:i,owner:document.body},v={distance:5,cursorAt:{left:10,top:t.isTouch?-40/t.zoomLevel():10},scope:"default",start:i,drag:i,stop:i,destroy:i,owner:document.body,cue:function(){return n("<span />")}};t.scripts.push("telerik.draganddrop.js"),t.droppable=function(t){n.extend(this,a,t),n(this.owner).delegate(this.selector,"mouseenter",n.proxy(this._over,this)).delegate(this.selector,e,n.proxy(this._drop,this)).delegate(this.selector,"mouseleave",n.proxy(this._out,this)),this.scope in u?u[this.scope].push(this):u[this.scope]=[this]},t.droppable.prototype={_over:function(n){this._raise(n,this.over)},_out:function(n){this._raise(n,this.out)},_drop:function(t){this._raise(t,n.proxy(function(n){this.drop(n),n.destroy(n)},this))},_raise:function(i,u){var f=r[this.scope],e=n(t.eventCurrentTarget(i)).closest(this.selector);f&&u(n.extend(i,f,{$droppable:e}))}},t.dragCue=function(t){return n('<div class="t-header t-drag-clue" />').html(t).prepend('<span class="t-icon t-drag-status t-denied" />').appendTo(document.body)},t.dragCueStatus=function(n,t){n.find(".t-drag-status").attr("class","t-icon t-drag-status").addClass(t)},t.draggable=function(i){n.extend(this,v,i),n(this.owner).delegate(this.selector,s,n.proxy(this._wait,this)).delegate(this.selector,"dragstart",t.preventDefault),this._startProxy=n.proxy(this._start,this),this._destroyProxy=n.proxy(this._destroy,this),this._stopProxy=n.proxy(this._stop,this),this._dragProxy=n.proxy(this._drag,this)},t.draggable.get=function(n){return r[n]},t.draggable.prototype={_raise:function(t,i){var u=r[this.scope];if(u)return i(n.extend(t,u))},_startDrag:function(t,i){if(t=n(t),this.$target=t,i)this._startPosition=i;else{var r=t.offset();this._startPosition={x:r.left,y:r.top}}n(document).bind(h+"."+this.scope,this._startProxy).bind(e+"."+this.scope,this._destroyProxy)},_wait:function(i){return t.isTouch&&i.stopImmediatePropagation(),this._startDrag(i.currentTarget,t.touchLocation(i)),n(document.documentElement).trigger(s,i),t.isTouch?void 0:!1},_start:function(i){var u=t.touchLocation(i),s=this._startPosition.x-u.x,c=this._startPosition.y-u.y,l=Math.sqrt(s*s+c*c),f;l>=this.distance&&(t.isTouch&&(i.stopImmediatePropagation(),i.preventDefault()),f=o[this.selector],f||(f=o[this.selector]=this.cue({$draggable:this.$target})),n(document).unbind("."+this.scope).bind(h+"."+this.scope,this._dragProxy).bind(e+"."+this.scope,this._stopProxy).bind("keydown."+this.scope,this._stopProxy).bind("selectstart."+this.scope,!1),r[this.scope]={$cue:f.css({position:"absolute",left:u.x+this.cursorAt.left,top:u.y+this.cursorAt.top}),$draggable:this.$target,destroy:this._destroyProxy},this._raise(i,this.start)===!1&&this._destroy(i))},_drag:function(i){var s,e;if(t.isTouch&&i.stopImmediatePropagation(),s=t.touchLocation(i),t.isTouch&&c(u)&&(e=t.eventTarget(i),e)){var v=u[this.scope],o=l(e,v),h=o.owner,a=f.owner,y=a!=h;y&&(a!=null&&"_out"in f&&f._out(i),h&&n.contains(h,e)&&"_over"in o&&o._over(i),f=o)}this._raise(i,this.drag),r[this.scope].$cue.css({left:s.x+this.cursorAt.left,top:s.y+this.cursorAt.top})},_stop:function(i){var h,a,o,s;t.isTouch&&i.stopImmediatePropagation(),(i.type==e||i.keyCode==27)&&n(document).unbind("."+this.scope),t.isTouch&&c(u)&&(h=t.eventTarget(i),h&&(a=u[this.scope],o=l(h,a),o.owner&&"_drop"in o&&(f={owner:[null]},o._drop(i)))),this._raise(i,this.stop)===!1?this._destroy(i):(s=r[this.scope],s&&s.$cue.animate(s.$draggable.offset(),"fast",this._destroyProxy))},_destroy:function(t){n(document).unbind("."+this.scope),this._raise(t,this.destroy),r[this.scope]=null,o[this.selector]=null}}})(jQuery);