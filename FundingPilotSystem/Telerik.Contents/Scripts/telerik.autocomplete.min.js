(function(n){var t=n.telerik;t.scripts.push("telerik.autocomplete.js"),t.autocomplete=function(i,r){function f(n,i){return n.value.substring(0,t.caretPos(n)).split(i).length-1}function e(n){clearTimeout(n.timeout),n.timeout=setTimeout(function(){n.filtering.filter(n)},n.delay)}function o(i){var f=this.trigger,u=this.dropDown,r=i.keyCode||i.which,h,c,l,a,v;if(this.lastKeyCode=r,!i.shiftKey&&r>36&&r<41&&r!=37&&r!=39&&(i.preventDefault(),u.isOpened())){u.$items||this.fill();var s=u.$items,y=s.filter(".t-state-selected:first"),o=[];r==38?(h=y.prev(),o=h.length?h:s.last()):r==40&&(c=y.next(),o=c.length?c:s.first()),o.length&&(l=o[0],this.highlight(l),u.scrollTo(l),this.filtering.autoFill(this,o.text()))}(r==8||r==46)&&(a=this.$element,a.val()!=""&&e(this),setTimeout(n.proxy(function(){a.val()==""&&f.close()},this),0)),r==13&&(u.isOpened()&&i.preventDefault(),u.$items&&(v=u.$items.filter(".t-state-selected:first"),v.length>0&&this.select(v[0])),f.change(),f.close(),t.list.moveToEnd(this.element)),(r==27||r==9)&&(clearTimeout(this.timeout),f.change(),f.close())}n.extend(this,r);var u=this.$element=n(i).addClass("t-widget t-autocomplete t-input").attr("autocomplete","off").bind("paste",n.proxy(function(){e(this)},this));this.$text=u,this.element=i,this.trigger=new t.list.trigger(this),this.trigger.change=function(){var n=this.component.text(),i=this.component.previousValue;(i==undefined||n!=i)&&t.trigger(this.component.element,"valueChange",{value:n}),this.component.previousValue=n},this.loader=new t.list.loader(this),this.loader.showBusy=function(){this.busyTimeout=setTimeout(n.proxy(function(){this.component.$element.addClass("t-loading")},this),100)},this.loader.hideBusy=function(){clearTimeout(this.busyTimeout),this.component.$element.removeClass("t-loading")},this.filtering=new t.list.filtering(this),this.filtering.autoFill=function(n,i){var s,h,c;if(n.autoFill&&n.lastKeyCode!=8&&n.lastKeyCode!=46){var u=n.$text[0],l=u.value,r=n.separator,e=t.caretPos(u),a=n.multiple,v=a&&r?t.lastIndexOf(l.substring(0,e),r):-1,p=v!=-1?v+r.length:0,o=l.substring(p,e),y=i.toLowerCase().indexOf(o.toLowerCase());y!=-1&&(s=i.substring(y+o.length),a?(h=l.split(r),c=f(u,r),h[c]=o+s,u.value=h.join(r)+(n.multiple&&c!=0&&c==h.length-1?r:"")):u.value=o+s,t.list.selection(u,e,e+s.length))}},this.enable=function(){u.removeClass("t-state-disabled").removeAttr("disabled")},this.disable=function(){u.addClass("t-state-disabled").attr("disabled","disabled")},this.filtering.multiple=n.proxy(function(n){return this.multiple&&(n=n.split(this.separator),n=n[f(this.$text[0],this.separator)]),n},this),this.dropDown=new t.dropDown({attr:this.dropDownAttr,effects:this.effects,onClick:n.proxy(function(n){this.select(n.item),this.trigger.change(),this.trigger.close()},this)}),this.dropDown.$element.css("direction",u.closest(".t-rtl").length?"rtl":""),this.fill=function(n){function u(n){var t=n.highlightFirst?f.$items.first():null;t&&t.addClass("t-state-selected")}var i=this.loader,f=this.dropDown,o=this.minChars,e=this.text(),s=e.length,r;f.$items||i.ajaxError||((i.isAjax()||this.onDataBinding)&&s>=o?(r={},r[this.queryString.text]=e,i.ajaxRequest(function(i){this.dataBind(i,!0),u(this),t.trigger(this.element,"dataBound"),this.trigger.change(),n&&n()},{data:r})):(this.dataBind(this.data,!0),u(this),n&&n()))},this.text=function(){return arguments.length>0&&(this.previousValue=arguments[0]),this.$text.val.apply(this.$text,arguments)},this.value=function(){return this.text.apply(this,arguments)},this.select=function(n){var i=this.highlight(n);if(i==-1)return i;var u=this.filteredDataIndexes,h=(u&&u.length)>0?u[i]:i,n=this.data[h],e=n.Text?n.Text:n,t=e;if(this.multiple){var o=this.$element,r=this.separator,s=f(o[0],r);t=o.val().split(r),t[s]=e,t=t.join(r)+(s==t.length-1?r:"")}this.$text.val(t)},t.list.common.call(this),t.list.filters.call(this),t.list.initialize.call(this),this.dataBind=function(n,t){this.data=n=n||[],this.dropDown.dataBind(n,this.encoded),t||this.$text.val("")},u.bind({focus:n.proxy(function(n){n.stopPropagation()},this),keydown:n.proxy(o,this),keypress:n.proxy(function(i){var r=i.keyCode||i.charCode;if(r==0||n.inArray(r,t.list.keycodes)!=-1||i.ctrlKey)return!0;e(this)},this)}),n(document.documentElement).bind("mousedown",n.proxy(function(t){var r=this.dropDown.$element.parent(),u=r.length;(u||i===t.target)&&(!u||n.contains(i,t.target)||n.contains(r[0],t.target))||(this.trigger.change(),this.trigger.close())},this))},n.fn.tAutoComplete=function(n){return t.create(this,{name:"tAutoComplete",init:function(n,i){return new t.autocomplete(n,i)},options:n})},n.fn.tAutoComplete.defaults={encoded:!0,effects:t.fx.slide.defaults(),filter:1,delay:200,minChars:1,cache:!0,autoFill:!1,highlightFirst:!1,queryString:{text:"text"},multiple:!1,separator:", "}})(jQuery);