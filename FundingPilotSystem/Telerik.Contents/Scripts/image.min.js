function ImageCommand(n){function i(n,i){if(t.src&&t.src!="http://")if(n)dom.attr(n,t);else return n=dom.create(documentFromRange(i),"img",t),n.onload=n.onerror=function(){n.removeAttribute("complete"),n.removeAttribute("width"),n.removeAttribute("height")},i.deleteContents(),i.insertNode(n),i.setStartAfter(n),i.setEndAfter(n),selectRange(i),!0;return!1}Command.call(this,n),this.async=!0;var t;this.redo=function(){var n=this.lockRange();i(RangeUtils.image(n),n)||this.releaseRange(n)},this.exec=function(){function o(o){t={src:$("#t-editor-image-url",e.element).val(),alt:$("#t-editor-image-title",e.element).val()},c=i(n,u),f(o),r.change&&r.change()}function f(n){n.preventDefault(),e.destroy(),windowFromDocument(documentFromRange(u)).focus(),c||r.releaseRange(u)}function l(){h&&new $t.imageBrowser($(this).find(".t-image-browser"),$.extend(s,{apply:o,element:r.editor.element,localization:r.editor.localization}))}var u=this.lockRange(),c=!1,n=RangeUtils.image(u),r=this,s=this.editor.fileBrowser,h=s&&s.selectUrl!==undefined,e=$t.window.create($.extend({width:750},this.editor.dialogOptions,{title:"Insert image",html:(new $.telerik.stringBuilder).cat('<div class="t-editor-dialog">').catIf('<div class="t-image-browser"><\/div>',h).cat("<ol>").cat('<li class="t-form-text-row"><label for="t-editor-image-url">Web address<\/label><input type="text" class="t-input" id="t-editor-image-url"/><\/li>').cat('<li class="t-form-text-row"><label for="t-editor-image-title">Tooltip<\/label><input type="text" class="t-input" id="t-editor-image-title"/><\/li>').cat("<\/ol>").cat('<div class="t-button-wrapper">').cat('<button class="t-dialog-insert t-button">Insert<\/button>').cat("&nbsp;or&nbsp;").cat('<a href="#" class="t-dialog-close t-link">Close<\/a>').cat("<\/div>").cat("<\/div>").string(),onClose:f,onActivate:l})).hide().find(".t-dialog-insert").click(o).end().find(".t-dialog-close").click(f).end().find(".t-form-text-row input").keydown(function(n){n.keyCode==13?o(n):n.keyCode==27&&f(n)}).end().toggleClass("t-imagebrowser",h).find("#t-editor-image-url").val(n?n.getAttribute("src",2):"http://").end().find("#t-editor-image-title").val(n?n.alt:"").end().show().data("tWindow").center();$("#t-editor-image-url",e.element).focus().select()}}