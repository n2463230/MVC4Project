function PendingFormats(n){this.editor=n,this.formats=[]}PendingFormats.prototype={apply:function(n){var t,s,i,r,f,e,u,o;if(this.hasPending()){if(t=new Marker,t.addCaret(n),s=n.startContainer.childNodes[n.startOffset],i=s.previousSibling,i.nodeValue||(i=i.previousSibling),n.setStart(i,i.nodeValue.length-1),t.add(n),textNodes(n).length==0){t.remove(n),n.collapse(!0),this.editor.selectRange(n);return}for(r=t.end.previousSibling.previousSibling,e=this.formats,u=0;u<e.length;u++)f=e[u],o=f.command($.extend({range:n},f.params)),o.editor=this.editor,o.exec(),n.selectNode(r);t.remove(n),r.parentNode&&(n.setStart(r,1),n.collapse(!0)),this.clear(),this.editor.selectRange(n)}},hasPending:function(){return this.formats.length>0},isPending:function(n){return!!this.getPending(n)},getPending:function(n){for(var i=this.formats,t=0;t<i.length;t++)if(i[t].name==n)return i[t];return},toggle:function(n){for(var i=this.formats,t=0;t<i.length;t++)if(i[t].name==n.name){i[t].params&&i[t].params.value!=n.params.value?i[t].params.value=n.params.value:i.splice(t,1);return}i.push(n)},clear:function(){this.formats=[]}};